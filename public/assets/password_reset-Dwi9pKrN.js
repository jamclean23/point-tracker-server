import{r as c,j as e,c as b}from"./client-nMGDAYsi.js";function y(s,r,a,n){a(""),r(s),n(s)}function C(s,r,a){r(s),a(s)}function p(s,r,a,n){console.log("VALIDATING"),console.log({password:s}),console.log({confirmPassword:r});const t=[],o=[];return typeof s!="string"&&t.push("Must be a string"),s.length<8&&t.push("Must be at least 8 characters"),s||t.push("May not be blank"),s.length>20&&t.push("Must be no more than 20 characters"),/\s/.test(s)&&t.push("Spaces are not permitted"),s!==r&&o.push("Passwords do not match"),t.length?a(t[t.length-1]):a(""),o.length?n(o[o.length-1]):n(""),!(t.length||o.length)}async function N(s,r,a,n,t,o="test token",d,l){if(p(s,r,a,n))try{t(!0);const h=await(await fetch("/auth/password_change",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer: ${o}`},body:JSON.stringify({password:s})})).json();h.result==="success"?l(!0):d(h.message)}catch(u){console.error(u.message),console.trace(),d("An error occurred. Please try again later or contact an administrator.")}finally{t(!1)}}function v(s){const r=document.getElementById("root").dataset.jwt;s(r)}function E(){const[s,r]=c.useState(""),[a,n]=c.useState(""),[t,o]=c.useState(""),[d,l]=c.useState(""),[u,h]=c.useState(!1),[g,m]=c.useState(""),[f,j]=c.useState(!1),[x,w]=c.useState("");c.useEffect(()=>{v(w)},[]);const P=e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"inputWrapper",children:[e.jsx("label",{children:"New Password"}),e.jsx("input",{placeholder:"New Password",type:"password",value:s,onChange:i=>y(i.target.value,r,o,()=>{p(i.target.value,t,n,l)})}),e.jsx("span",{className:"errSpan errText",children:a||" "})]}),e.jsxs("div",{className:"inputWrapper",children:[e.jsx("label",{children:"Confirm Password"}),e.jsx("input",{placeholder:"Confirm Password",type:"password",value:t,onChange:i=>C(i.target.value,o,()=>{p(s,i.target.value,n,l)})}),e.jsx("span",{className:"errSpan errText",children:d||" "})]}),e.jsx("div",{className:"btnWrapper",children:e.jsx("button",{id:"submitBtn",disabled:u,onClick:()=>N(s,t,n,l,h,x,m,j),children:"Submit"})}),e.jsx("p",{id:"serverMessage",className:"errText",children:g})]}),S=e.jsx(e.Fragment,{children:e.jsx("p",{id:"successMessage",children:"Your password has been updated. Please log in on the Point Tracker mobile app."})});return e.jsxs(e.Fragment,{children:[e.jsxs("h1",{children:[e.jsx("span",{className:"pointSpan",children:"Point "}),e.jsx("span",{className:"trackerSpan",children:"Tracker"})]}),e.jsxs("main",{children:[e.jsx("h2",{children:"Password Reset"}),f?S:P]})]})}b(document.getElementById("root")).render(e.jsx(c.StrictMode,{children:e.jsx(E,{})}));
